@model Treatise
<div class="col-lg-12">
    <div class="ibox float-e-margins">
        <div class="ibox-content">
            <form method="post" class="form-horizontal" id="treatise-From" action="@Url.Action("add")">
                <div class="form-group">
                    <div class="col-sm-6">
                        <label class="col-sm-4 control-label">年份</label>
                        <div class="col-sm-8">
                            @Html.DropDownListFor(d => d.ApplicableYear, ViewBag.ApplicableYear as SelectList, new { @class = "form-control", datatype = "*" })
                            <span class="help-block m-b-none Validform_checktip"></span>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <label class="col-sm-4 control-label">标题</label>
                        <div class="col-sm-8">
                            @Html.TextBoxFor(d => d.TreatiseName, new { @class = "form-control", datatype = "*" })
                            <span class="help-block m-b-none Validform_checktip"></span>
                        </div>
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group">
                    <div class="col-sm-6">
                        <label class="col-sm-4 control-label">选择专业</label>
                        <div class="col-sm-8">
                            @Html.DropDownListFor(d => d.SchoolID, ViewBag.SchoolID as SelectList, new { @class = "form-control", datatype = "*" })
                            <span class="help-block m-b-none Validform_checktip">@Html.ValidationMessageFor(d => d.SchoolID)</span>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <label class="col-sm-4 control-label">开题报告方式</label>
                        <div class="col-sm-8">
                            @Html.DropDownListFor(d => d.IsReport, ViewBag.IsReport as SelectList, new { @class = "form-control", datatype = "*" })
                            <span class="help-block m-b-none Validform_checktip"></span>
                        </div>
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group">
                    <div class="col-sm-6">
                        <label class="col-sm-4 control-label">选题显示老师姓名</label>
                        <div class="col-sm-8">
                            @Html.DropDownListFor(d => d.ShowTeacher, ViewBag.ShowTeacher as SelectList, new { @class = "form-control", datatype = "*" })
                            <span class="help-block m-b-none Validform_checktip"></span>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <label class="col-sm-4 control-label">选题方式</label>
                        <div class="col-sm-8">
                            @Html.DropDownListFor(d => d.ChooseTeacher, ViewBag.ChooseTeacher as SelectList, new { @class = "form-control ", datatype = "*" })
                            <span class="help-block m-b-none Validform_checktip"></span>
                        </div>
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group">
                    <div class="col-md-6">
                        <label class="col-md-4 control-label">每个学生最大选题数</label>
                        <div class="col-md-8">
                            @Html.TextBoxFor(d => d.SubjectMax, new { @class = "form-control", datatype = "n" })
                            <span class="help-block m-b-none Validform_checktip"></span>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <label class="col-md-4 control-label">选题审核顺序</label>
                        <div class="col-md-8">
                            @Html.DropDownListFor(d => d.CheckOrder, ViewBag.CheckOrder as SelectList, new { @class = "form-control " })
                        </div>
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group">
                    <div class="col-sm-6">
                        <label class="col-sm-4 control-label">开始时间</label>
                        <div class="col-sm-8">
                            @Html.TextBoxFor(d => d.StartTime, "{0:yyyy-MM-dd}", new { @class = "form-control ", datatype = "*" })
                            <span class="help-block m-b-none Validform_checktip"></span>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <label class="col-sm-4 control-label">结束时间</label>
                        <div class="col-sm-8">
                            @Html.TextBoxFor(d => d.EndTime, "{0:yyyy-MM-dd}", new { @class = "form-control", datatype = "*" })
                            <span class="help-block m-b-none Validform_checktip"></span>
                        </div>
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group">
                    <div class="col-sm-6">
                        <label class="col-sm-4 control-label">时间分</label>
                        <div class="col-sm-8">
                            @Html.TextBoxFor(d => d.TimeGrades, new { @class = "form-control", onkeyup = "changequalitygrades()", datatype = "*" })
                            <span class="help-block m-b-none Validform_checktip">@Html.ValidationMessageFor(d => d.TimeGrades)</span>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <label class="col-sm-4 control-label">质量分</label>
                        <div class="col-sm-8">
                            @Html.TextBoxFor(d => d.QualityGrades, new { @class = "form-control", datatype = "*" })
                            <span class="help-block m-b-none Validform_checktip">@Html.ValidationMessageFor(d => d.QualityGrades)</span>
                        </div>
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group">
                    <div class="col-sm-6">
                        <label class="col-sm-4 control-label">及格分</label>
                        <div class="col-sm-8">
                            @Html.TextBoxFor(d => d.PassMark, new { @class = "form-control", datatype = "treatisepassmark,*" })
                            <span class="help-block m-b-none Validform_checktip">@Html.ValidationMessageFor(d => d.PassMark)</span>
                        </div>
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group">
                    <div class="col-md-6">
                        <label class="col-md-4 control-label">阶段开启模式</label>
                        <div class="col-md-8">
                            @Html.DropDownListFor(d => d.StageMode, ViewBag.StageMode as SelectList, new { @class = "form-control", datatype = "*" })
                            <span class="help-block m-b-none Validform_checktip"></span>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <label class="col-md-4 control-label">选题需要管理员审核</label>
                        <div class="col-md-8">
                            @Html.DropDownListFor(d => d.AdminChoose, ViewBag.AdminChoose as SelectList, new { @class = "form-control", datatype = "*" })
                            <span class="help-block m-b-none Validform_checktip"></span>
                        </div>
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">描述</label>
                    <div class="col-sm-8">
                        @Html.TextBoxFor(d => d.Comment, new { @class = "form-control" })
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group">
                    <label class="col-sm-2 control-label"></label>
                    <div class="col-sm-8">
                        @Html.ValidationMessageFor(d => d.Comment)
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-sm-4 col-sm-offset-2">
                        <button class="btn btn-primary" type="submit">保存内容</button>
                        <a class="btn btn-white" onclick="return confirm('返回后您输入的数据将不被储存，确认返回吗？')" href="@Url.Action("search")">取消</a>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    $.getScript("/Content/kindeditor/kindeditor-all-min.js", function () {
        $.getScript("/Content/Scripts/Validform_v5.3.2.js", function () {
            $.getScript("/Content/My97DatePicker/WdatePicker.js", function () {
                KindEditor.basePath = '/Content/kindeditor/';
                var editor = KindEditor.create('#Comment', {
                    resizeType: 1,
                    allowPreviewEmoticons: false,
                    allowImageUpload: false,
                    afterCreate: function () {
                        var self = this;
                        KindEditor.ctrl(document, 13, function () {
                            self.sync();
                        });
                        KindEditor.ctrl(self.edit.doc, 13, function () {
                            self.sync();
                        });
                    },
                    items: [
                        'fontname', 'fontsize', '|', 'forecolor', 'hilitecolor', 'bold', 'italic', 'underline',
                        'removeformat', '|', 'justifyleft', 'justifycenter', 'justifyright', 'insertorderedlist',
                        'insertunorderedlist', '|', 'emoticons', 'link']
                });
                var Validform = $("#treatise-From").Validform({
                    tiptype: 3,
                    ignoreHidden: true
                });
                $("#StartTime").click(function () {
                    WdatePicker({ minDate: "%y-%M-%d", dateFmt: "yyyy-MM-dd", errDealMode: true });
                });
                $("#EndTime").click(function () {
                    WdatePicker({ minDate: "#F{$dp.$D('StartTime')||'%y-%M-%d'}", dateFmt: "yyyy-MM-dd", errDealMode: true });
                });
            });
        });
    });
    function changequalitygrades() {
        var time = $("#TimeGrades").val() - 0;
        var qua = $("#QualityGrades").val() - 0;
        if (isNaN(time)) {
            $("#TimeGrades").val("");
        } else {
            if (time < 100)
                $("#QualityGrades").val(100 - time);
        }
    }
</script>
